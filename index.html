<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Lua Obfuscator / Deobfuscator</title>
<style>
    body { font-family: Arial, sans-serif; background:#1a1a1a; color:white; margin:0; padding:0; }
    header { background:#ff7a00; padding:15px; text-align:center; font-size:24px; font-weight:bold; }
    .tabs { display:flex; background:#ff8f26; }
    .tab { flex:1; padding:12px; text-align:center; cursor:pointer; background:#ff8f26; font-weight:bold; }
    .tab.active { background:#ff7a00; }
    .page { display:none; padding:20px; }
    textarea { width:100%; height:260px; background:#111; color:#ffa64d; border:2px solid #ff7a00; padding:10px; resize:none; }
    button { background:#ff7a00; border:none; padding:12px 20px; font-size:16px; cursor:pointer; margin-top:12px; color:white; font-weight:bold; }
    .loader { width:0; height:6px; background:#ff7a00; margin-top:10px; transition:0.3s; }
</style>
</head>
<body>
<header>Lua Obfuscator / Deobfuscator</header>
<div class="tabs">
    <div class="tab active" onclick="showPage('obf')">Obfuscate</div>
    <div class="tab" onclick="showPage('deobf')">Deobfuscate</div>
</div>

<div id="obf" class="page" style="display:block;">
    <textarea id="inputObf" placeholder="Paste Lua code..."></textarea>
    <button onclick="runObfuscate()">Obfuscate</button>
    <div id="load1" class="loader"></div>
    <textarea id="outputObf" placeholder="Output..."></textarea>
</div>

<div id="deobf" class="page">
    <textarea id="inputDeobf" placeholder="Paste obfuscated Lua..."></textarea>
    <button onclick="runDeobfuscate()">Deobfuscate</button>
    <div id="load2" class="loader"></div>
    <textarea id="outputDeobf" placeholder="Output..."></textarea>
</div>

<script>
function showPage(id){
    document.querySelectorAll('.page').forEach(p=>p.style.display='none');
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.getElementById(id).style.display='block';
    event.target.classList.add('active');
}

function base64Encode(str){ return btoa(unescape(encodeURIComponent(str))); }
function base64Decode(str){ return decodeURIComponent(escape(atob(str))); }

function runObfuscate(){
    const bar=document.getElementById('load1'); bar.style.width='100%';
    setTimeout(()=>{ bar.style.width='0'; },400);

    let code=document.getElementById('inputObf').value;
    if(!code.trim()){ document.getElementById('outputObf').value=''; return; }

    let b64=base64Encode(code);

    let oneLine=`loadstring((function(b)local bit=bit32 local c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'local d={}for i=1,#c do d[c:sub(i,i)]=i-1 end local t={}local n=1 for i=1,#b do local v=d[b:sub(i,i)]if v then t[n]=v n=n+1 end end local o={}local k=1 for i=1,#t,4 do local a=t[i]local b=t[i+1]local c=t[i+2]local d=t[i+3]o[k]=string.char(bit.band(bit.bor(bit.lshift(a,2), bit.rshift(b or 0,4)),255))k=k+1 if c then o[k]=string.char(bit.band(bit.bor(bit.lshift(b,4), bit.rshift(c,2)),255))k=k+1 end if d then o[k]=string.char(bit.band(bit.bor(bit.lshift(c,6), d),255))k=k+1 end end return table.concat(o)end)('((function(b)local c='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'local d={}for i=1,#c do d[c:sub(i,i)]=i-1 end local t={}local n=1 for i=1,#b do local v=d[b:sub(i,i)]if v then t[n]=v n=n+1 end end local o={}local k=1 for i=1,#t,4 do local a=t[i]local b=t[i+1]local c=t[i+2]local d=t[i+3]o[k]=string.char(((a<<2)|(b>>4))&255)k=k+1 if c then o[k]=string.char(((b<<4)|(c>>2))&255)k=k+1 end if d then o[k]=string.char(((c<<6)|d)&255)k=k+1 end end return table.concat(o)end)('${b64}'))()`;

    document.getElementById('outputObf').value = oneLine;
}

function runDeobfuscate(){
    const bar=document.getElementById('load2'); bar.style.width='100%';
    setTimeout(()=>{ bar.style.width='0'; },400);

    let code=document.getElementById('inputDeobf').value;
    let match = code.match(/'([^']+)'/);
    if(!match){ document.getElementById('outputDeobf').value='Failed: No Base64 found.'; return; }

    try{
        let decoded = base64Decode(match[1]);
        document.getElementById('outputDeobf').value = decoded;
    }catch(e){ document.getElementById('outputDeobf').value='Decode failed.'; }
}
</script>
</body>
</html>
